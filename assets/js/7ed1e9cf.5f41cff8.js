"use strict";(self.webpackChunkgp_doc_github_io=self.webpackChunkgp_doc_github_io||[]).push([[683],{413:(r,n,e)=>{e.r(n),e.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var t=e(6070),s=e(5710);const a={sidebar_position:4},i="\u4e8b\u52a1(transaction)",c={id:"jakarta-ee/transaction",title:"\u4e8b\u52a1(transaction)",description:"\u4e8b\u52a1\u662f\u4e00\u7ec4\u64cd\u4f5c\u7684\u96c6\u5408, \u8fd9\u4e9b\u64cd\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u6267\u884c, \u786e\u4fdd\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027. Graphoenix \u6839\u636e Jakarta Transactions \u534f\u8bae\u5bf9\u4e8b\u52a1\u8fdb\u884c\u7ba1\u7406",source:"@site/docs/jakarta-ee/transaction.md",sourceDirName:"jakarta-ee",slug:"/jakarta-ee/transaction",permalink:"/docs/jakarta-ee/transaction",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"\u914d\u7f6e(config)",permalink:"/docs/jakarta-ee/config"},next:{title:"\u5f02\u6b65\u548c\u540c\u6b65(async/await)",permalink:"/docs/jakarta-ee/reactor"}},d={},o=[{value:"\u4e8b\u52a1\u6ce8\u89e3",id:"\u4e8b\u52a1\u6ce8\u89e3",level:2},{value:"@Transactional",id:"transactional",level:3},{value:"TxType",id:"txtype",level:3}];function l(r){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"\u4e8b\u52a1transaction",children:"\u4e8b\u52a1(transaction)"}),"\n",(0,t.jsxs)(n.p,{children:["\u4e8b\u52a1\u662f\u4e00\u7ec4\u64cd\u4f5c\u7684\u96c6\u5408, \u8fd9\u4e9b\u64cd\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u6267\u884c, \u786e\u4fdd\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u5b8c\u6574\u6027. Graphoenix \u6839\u636e ",(0,t.jsx)(n.a,{href:"https://jakarta.ee/specifications/transactions/2.0/jakarta-transactions-spec-2.0",children:"Jakarta Transactions"})," \u534f\u8bae\u5bf9\u4e8b\u52a1\u8fdb\u884c\u7ba1\u7406"]}),"\n",(0,t.jsx)(n.mermaid,{value:"flowchart LR\r\n    micro1{{\u5fae\u670d\u52a11}}\r\n    micro2{{\u5fae\u670d\u52a12}}\r\n    micro3{{\u5fae\u670d\u52a13}}\r\n    success1(\u6210\u529f)\r\n    success2(\u6210\u529f)\r\n    success3(\u6210\u529f)\r\n    error1(\u5f02\u5e38)\r\n    error2(\u5f02\u5e38)\r\n    error3(\u5f02\u5e38)\r\n    db1[(MySQL)]\r\n    db2[(Postgre)]\r\n    db3[(MongoDB)]\r\n    error1 == \u4e8b\u52a1\u8865\u507f ==> micro2 & micro3\r\n    micro1 -- \u8c03\u7528 --\x3e micro2 --\x3e success2\r\n    micro2 -.-> error2 -. \u56de\u6eda .-> db2\r\n    error2 -.-> error1\r\n\r\n    micro1 -.-> error1 -. \u56de\u6eda .-> db1\r\n    micro1 --\x3e success1 -- \u63d0\u4ea4 --\x3e db1\r\n\r\n    success2 -- \u8c03\u7528 --\x3e micro3 --\x3e success3 -- \u63d0\u4ea4 --\x3e db3\r\n    success2 -- \u63d0\u4ea4 --\x3e db2\r\n    micro3 -.-> error3 -. \u56de\u6eda .-> db3\r\n    error3 -.-> error1"}),"\n",(0,t.jsx)(n.h2,{id:"\u4e8b\u52a1\u6ce8\u89e3",children:"\u4e8b\u52a1\u6ce8\u89e3"}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"#transactional",children:(0,t.jsx)(n.code,{children:"@Transactional"})})," \u6ce8\u89e3\u58f0\u660e\u4e8b\u52a1"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@GraphQLApi\r\n@ApplicationScoped\r\npublic class SystemApi {\r\n\r\n    @Mutation\r\n    // highlight-start\r\n    @Transactional\r\n    // highlight-end\r\n    public RegisterResult register(RegisterInput registerInput) {\r\n        // ...\r\n    }\r\n\r\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"transactional",children:"@Transactional"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u5c5e\u6027"}),(0,t.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,t.jsx)(n.th,{children:"\u9ed8\u8ba4\u503c"}),(0,t.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"value"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#txtype",children:"TxType"})}),(0,t.jsx)(n.td,{children:"REQUIRED"}),(0,t.jsx)(n.td,{children:"\u4e8b\u52a1\u4f20\u64ad\u7c7b\u578b"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"rollbackOn"}),(0,t.jsx)(n.td,{children:"Class[]"}),(0,t.jsx)(n.td,{children:"--"}),(0,t.jsx)(n.td,{children:"\u9700\u8981\u56de\u6eda\u7684\u5f02\u5e38\u7c7b, \u4f18\u5148\u7ea7\u4f4e\u4e8e dontRollbackOn"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"dontRollbackOn"}),(0,t.jsx)(n.td,{children:"Class[]"}),(0,t.jsx)(n.td,{children:"--"}),(0,t.jsx)(n.td,{children:"\u4e0d\u9700\u8981\u56de\u6eda\u7684\u5f02\u5e38\u7c7b, \u4f18\u5148\u7ea7\u9ad8\u4e8e rollbackOn"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"txtype",children:"TxType"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,t.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"REQUIRED"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u62e6\u622a\u5668\u5fc5\u987b\u5f00\u59cb\u65b0\u7684 Jakarta Transactions \u4e8b\u52a1, \u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u6b64\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u7ee7\u7eed, \u5e76\u4e14\u4e8b\u52a1\u5fc5\u987b\u7531\u62e6\u622a\u5668\u5b8c\u6210 ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u6b64\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u7ee7\u7eed"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"REQUIRES_NEW"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u62e6\u622a\u5668\u5fc5\u987b\u5f00\u59cb\u65b0\u7684 Jakarta Transactions \u4e8b\u52a1, \u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u6b64\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u7ee7\u7eed, \u5e76\u4e14\u4e8b\u52a1\u5fc5\u987b\u7531\u62e6\u622a\u5668\u5b8c\u6210 ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u5219\u5fc5\u987b\u6682\u505c\u5f53\u524d\u4e8b\u52a1\u4e0a\u4e0b\u6587, \u5f00\u59cb\u65b0\u7684 Jakarta Transactions \u4e8b\u52a1, \u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u6b64\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u7ee7\u7eed, \u4e8b\u52a1\u5fc5\u987b\u5b8c\u6210, \u5e76\u4e14\u5fc5\u987b\u6062\u590d\u5148\u524d\u6682\u505c\u7684\u4e8b\u52a1"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"MANDATORY"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u5219\u5fc5\u987b\u629b\u51fa\u5d4c\u5957 TransactionalException \u7684 TransactionRequiredException ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u5219\u6258\u7ba1 bean \u65b9\u6cd5\u5c06\u5728\u8be5\u4e0a\u4e0b\u6587\u4e2d\u7ee7\u7eed\u6267\u884c"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SUPPORTS"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u5219\u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u7ee7\u7eed ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u5219\u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u8be5\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u7ee7\u7eed"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"NOT_SUPPORTED"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u5219\u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u7ee7\u7eed ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u5219\u5fc5\u987b\u6682\u505c\u5f53\u524d\u4e8b\u52a1\u4e0a\u4e0b\u6587, \u7136\u540e\u6258\u7ba1 bean \u65b9\u6cd5\u7684\u6267\u884c\u5fc5\u987b\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u7ee7\u7eed, \u5e76\u4e14\u4e4b\u524d\u6682\u505c\u7684\u4e8b\u52a1\u5fc5\u987b\u5728\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u540e\u7531\u6682\u505c\u5b83\u7684\u62e6\u622a\u5668\u6062\u590d"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"NEVER"}),(0,t.jsxs)(n.td,{children:["\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u8c03\u7528, \u5219\u6258\u7ba1 bean \u65b9\u6cd5\u6267\u884c\u5fc5\u987b\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u4e4b\u5916\u7ee7\u7eed ",(0,t.jsx)("br",{}),"\u5982\u679c\u5728\u4e8b\u52a1\u4e0a\u4e0b\u6587\u5185\u8c03\u7528, \u5219\u5fc5\u987b\u629b\u51fa\u5d4c\u5957 TransactionalException \u7684 InvalidTransactionException"]})]})]})]})]})}function h(r={}){const{wrapper:n}={...(0,s.R)(),...r.components};return n?(0,t.jsx)(n,{...r,children:(0,t.jsx)(l,{...r})}):l(r)}},5710:(r,n,e)=>{e.d(n,{R:()=>i,x:()=>c});var t=e(758);const s={},a=t.createContext(s);function i(r){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof r?r(n):{...n,...r}}),[n,r])}function c(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(s):r.components||s:i(r.components),t.createElement(a.Provider,{value:n},r.children)}}}]);
"use strict";(self.webpackChunkgp_doc_github_io=self.webpackChunkgp_doc_github_io||[]).push([[2756],{7331:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>r,metadata:()=>l,toc:()=>a});var t=s(6070),i=s(5710);const r={sidebar_position:5},d="\u8ba2\u9605(subscription)",l={id:"tutorial/subscription",title:"\u8ba2\u9605(subscription)",description:"\u5feb\u901f\u6d4f\u89c8\u8ba2\u9605\u793a\u4f8b",source:"@site/docs/tutorial/subscription.md",sourceDirName:"tutorial",slug:"/tutorial/subscription",permalink:"/docs/tutorial/subscription",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"\u53d8\u66f4(mutation)",permalink:"/docs/tutorial/mutation"},next:{title:"GPI(GraphQL API)",permalink:"/docs/tutorial/graphql-api"}},c={},a=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"Altair",id:"altair",level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u57fa\u672c\u8ba2\u9605",id:"\u57fa\u672c\u8ba2\u9605",level:2},{value:"<strong>\u8ba2\u9605\u63a5\u53e3</strong>",id:"\u8ba2\u9605\u63a5\u53e3",level:3},{value:"\u8ba2\u9605\u4e0e\u53d8\u66f4",id:"\u8ba2\u9605\u4e0e\u53d8\u66f4",level:3},{value:"<strong>\u8ba2\u9605\u53c2\u6570</strong>",id:"\u8ba2\u9605\u53c2\u6570",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"\u8ba2\u9605subscription",children:"\u8ba2\u9605(subscription)"}),"\n",(0,t.jsx)(n.p,{children:"\u5feb\u901f\u6d4f\u89c8\u8ba2\u9605\u793a\u4f8b"}),"\n",(0,t.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,t.jsx)(n.p,{children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-gradle",children:"repositories {\n    mavenCentral()\n    // highlight-start\n    jcenter()\n    // highlight-end\n}\n\ndependencies {\n    // highlight-start\n    implementation 'org.graphoenix:graphoenix-rabbitmq:0.1.3'\n    // highlight-end\n\n    // ...\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"altair",children:"Altair"}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"https://altairgraphql.dev/",children:"Altair GraphQL Client"})," \u8fdb\u884c\u8ba2\u9605\u6d4b\u8bd5\n",(0,t.jsx)(n.img,{src:"https://altairgraphql.dev/assets/img/app-shot.png",alt:"Altair",title:"Altair"})]}),"\n",(0,t.jsx)(n.h3,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u6253\u5f00 Request Handlers\n",(0,t.jsx)(n.img,{alt:"Request Handlers",src:s(8455).A+"",title:"Request Handlers",width:"868",height:"608"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["\u914d\u7f6e\u8ba2\u9605\u5730\u5740, \u9009\u62e9\u8ba2\u9605\u7c7b\u578b\u4e3a SSE\n",(0,t.jsx)(n.img,{alt:"Settings",src:s(7812).A+"",title:"Settings",width:"1036",height:"1280"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u57fa\u672c\u8ba2\u9605",children:"\u57fa\u672c\u8ba2\u9605"}),"\n",(0,t.jsx)(n.h3,{id:"\u8ba2\u9605\u63a5\u53e3",children:(0,t.jsx)(n.strong,{children:"\u8ba2\u9605\u63a5\u53e3"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u63a5\u53e3\u540d"}),(0,t.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,t.jsx)(n.th,{children:"\u53c2\u6570"}),(0,t.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,t.jsx)(n.th,{children:"\u793a\u4f8b (Type=User)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"(type)"}),(0,t.jsx)(n.td,{children:"(Type)"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#%E8%AE%A2%E9%98%85%E5%8F%82%E6%95%B0",children:"(Type)SubscriptionArguments"})}),(0,t.jsx)(n.td,{children:"\u8ba2\u9605\u5355\u6761"}),(0,t.jsx)(n.td,{children:"user"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"(type)List"}),(0,t.jsx)(n.td,{children:"[(Type)]"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#%E8%AE%A2%E9%98%85%E5%8F%82%E6%95%B0",children:"(Type)ListSubscriptionArguments"})}),(0,t.jsx)(n.td,{children:"\u8ba2\u9605\u5217\u8868"}),(0,t.jsx)(n.td,{children:"userList"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"(type)Connection"}),(0,t.jsx)(n.td,{children:"[(Type)]"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"#%E8%AE%A2%E9%98%85%E5%8F%82%E6%95%B0",children:"(Type)ConnectionSubscriptionArguments"})}),(0,t.jsx)(n.td,{children:"\u8ba2\u9605\u5206\u9875"}),(0,t.jsx)(n.td,{children:"userConnection"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"\u8ba2\u9605\u4e0e\u53d8\u66f4",children:"\u8ba2\u9605\u4e0e\u53d8\u66f4"}),"\n",(0,t.jsx)(n.p,{children:"\u53d8\u66f4\u8bf7\u6c42\u4f1a\u628a\u53d8\u66f4\u5185\u5bb9\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217(MQ)\u4e2d, \u8ba2\u9605\u4f1a\u6839\u636e\u7c7b\u578b\u548c\u5b57\u6bb5\u8ba2\u9605 MQ \u4e2d\u5bf9\u5e94\u7684\u9891\u9053, \u5728\u5339\u914d\u5230\u7b26\u5408\u6761\u4ef6\u7684\u53d8\u66f4\u5185\u5bb9\u540e\u901a\u8fc7 SSE \u63a8\u9001\u65b0\u7684\u6570\u636e"}),"\n",(0,t.jsx)(n.mermaid,{value:'flowchart LR\n    subgraph \u53d8\u66f4\n        request2[\u53d8\u66f4\u8bf7\u6c42]\n        mutation["// mutation.graphql\n        mutation {\n        &emsp;product(price: &quot;1000.00&quot;, where: {name: &quot;Laptop&quot}) {\n        &emsp;&emsp;id\n        &emsp;}\n        }"]\n        request2 --\x3e mutation\n    end\n    mutation -- \u63d0\u4ea4 --\x3e http\n    subgraph Graphoenix\n        mq[(Message Queue)]\n        types["// types.graphql\n        type Product {\n        &emsp;id: ID!\n        &emsp;name: String!\n        &emsp;price: Float!\n        }"]\n        schema["// schema.graphql\n        schema {\n        &emsp;subscription: Subscription\n        }\n        type Subscription {\n        &emsp;product: Product\n        &emsp;productList: [Product]\n        &emsp;productConnection: ProductConnection\n        }"]\n        types -- \u6784\u5efaSchema --\x3e schema -- \u6784\u5efa\u670d\u52a1 --\x3e http --\x3e mq --\x3e sse\n    end\n    sse -- \u63a8\u9001 --\x3e response\n    subgraph \u8ba2\u9605\n        request1[\u8ba2\u9605\u8bf7\u6c42]\n        subscription["// subscription.graphql\n        subscription {\n        &emsp;product {\n        &emsp;&emsp;name\n        &emsp;&emsp;price\n        &emsp;}\n        }"]\n        response["// response.json\n        {\n        &emsp;&quot;product&quot;: {\n        &emsp;&emsp;&quot;name&quot;: &quot;Laptop&quot;\n        &emsp;&emsp;&quot;price&quot;: 1000.00\n        &emsp;}\n        }"]\n        response --\x3e request1 --\x3e subscription\n    end\n    subscription -- \u6ce8\u518c\u8ba2\u9605 --\x3e http\n    style types text-align:left\n    style schema text-align:left\n    style subscription text-align:left\n    style mutation text-align:left\n    style response text-align:left'}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528\u4e0e\u5b57\u6bb5\u540c\u540d\u7684\u53c2\u6570\u6784\u9020\u67e5\u8be2\u6761\u4ef6, ",(0,t.jsx)(n.a,{href:"/docs/guide/types#operator",children:(0,t.jsx)(n.code,{children:"opr"})})," \u4f5c\u4e3a\u67e5\u8be2\u7b26\u53f7, ",(0,t.jsx)(n.a,{href:"/docs/guide/types#scalarenumexpression",children:(0,t.jsx)(n.code,{children:"val"})})," \u4f5c\u4e3a\u67e5\u8be2\u5185\u5bb9, \u5982\u679c\u67e5\u8be2\u5185\u5bb9\u4e3a\u6570\u7ec4\u5219\u4f7f\u7528 ",(0,t.jsx)(n.a,{href:"/docs/guide/types#scalarenumexpression",children:(0,t.jsx)(n.code,{children:"arr"})})]}),"\n",(0,t.jsx)(n.p,{children:"\u4f8b: \u8ba2\u9605\u6240\u6709\u7c7b\u578b\u662f VIP \u7684\u7528\u6237"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"subscription {\n  userList(userType: { val: VIP }) {\n    name\n    email\n    userType\n  }\n}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "userList": [\n      {\n        "name": "Alice",\n        "email": "alice@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Charlie",\n        "email": "charlie@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Edward",\n        "email": "edward@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "George",\n        "email": "george@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Ian",\n        "email": "ian@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Kyle",\n        "email": "kyle@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Mike",\n        "email": "mike@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Oliver",\n        "email": "oliver@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Quentin",\n        "email": "quentin@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Steve",\n        "email": "steve@example.com",\n        "userType": "VIP"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u901a\u8fc7\u53d8\u66f4\u65b0\u589e VIP \u7528\u6237 Uma"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  user(\n    name: "Uma"\n    email: "uma@example.com"\n    userType: VIP\n    phoneNumbers: ["13918124629", "18536492446"]\n  ) {\n    id\n    name\n    email\n    phoneNumbers\n    userType\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u8ba2\u9605\u6536\u5230\u65b0\u7684\u63a8\u9001\u6570\u636e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'{\n  "data": {\n    "userList": [\n      {\n        "name": "Alice",\n        "email": "alice@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Charlie",\n        "email": "charlie@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Edward",\n        "email": "edward@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "George",\n        "email": "george@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Ian",\n        "email": "ian@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Kyle",\n        "email": "kyle@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Mike",\n        "email": "mike@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Oliver",\n        "email": "oliver@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Quentin",\n        "email": "quentin@example.com",\n        "userType": "VIP"\n      },\n      {\n        "name": "Steve",\n        "email": "steve@example.com",\n        "userType": "VIP"\n      },\n      // highlight-start\n      {\n        "name": "Uma",\n        "email": "uma@example.com",\n        "userType": "VIP"\n      }\n      // highlight-end\n    ]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"\u8ba2\u9605\u53c2\u6570",children:(0,t.jsx)(n.strong,{children:"\u8ba2\u9605\u53c2\u6570"})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u53c2\u6570\u540d"}),(0,t.jsx)(n.th,{children:"\u7c7b\u578b"}),(0,t.jsx)(n.th,{children:"\u9ed8\u8ba4\u503c"}),(0,t.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,t.jsx)(n.th,{children:"SQL \u793a\u4f8b (x=10 y=5)"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"(field)"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/guide/types#scalarenumexpression",children:"(Scalar/Enum/Object)Expression"})}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u6761\u4ef6\u5b57\u6bb5"}),(0,t.jsxs)(n.td,{children:["SELECT id FROM t WHERE ",(0,t.jsx)(n.strong,{children:"t.field"})," = 'xyz'"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"first"}),(0,t.jsx)(n.td,{children:"Int"}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u83b7\u53d6\u524d x \u6761"}),(0,t.jsx)(n.td,{children:"SELECT id FROM t LIMIT 10"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"last"}),(0,t.jsx)(n.td,{children:"Int"}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u83b7\u53d6\u540e x \u6761"}),(0,t.jsx)(n.td,{children:"SELECT id FROM t ORDER BY id DESC LIMIT 10"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"offset"}),(0,t.jsx)(n.td,{children:"Int"}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u8df3\u8fc7 y \u6761"}),(0,t.jsx)(n.td,{children:"SELECT id FROM t LIMIT 5, 10"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"cond"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/guide/types#conditional",children:"Conditional"})}),(0,t.jsx)(n.td,{children:"AND"}),(0,t.jsx)(n.td,{children:"\u53c2\u6570\u5185\u6761\u4ef6\u7684\u7ec4\u5408\u5173\u7cfb"}),(0,t.jsxs)(n.td,{children:["WHERE t.field = 'xyz' ",(0,t.jsx)(n.strong,{children:"AND"})," t.field <> 'abc'"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"not"}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"false"}),(0,t.jsx)(n.td,{children:"\u6761\u4ef6\u53d6\u975e"}),(0,t.jsxs)(n.td,{children:["WHERE ",(0,t.jsx)(n.strong,{children:"NOT"})," (t.field = 'xyz' AND t.field <> 'abc')"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"exs"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/guide/types#objectexpression",children:"[(Object)Expression]"})}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u540c\u4e00\u5b57\u6bb5\u591a\u6b21\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u65f6\u53ef\u4f7f\u7528\u6b64\u53c2\u6570"}),(0,t.jsxs)(n.td,{children:["WHERE ",(0,t.jsx)(n.strong,{children:"("})," t.field = 'xyz' AND t.field <> 'abc' ",(0,t.jsx)(n.strong,{children:")"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"orderBy"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.a,{href:"/docs/guide/types#objectorderby",children:"[(Object)OrderBy]"})}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u6392\u5e8f\u5b57\u6bb5"}),(0,t.jsxs)(n.td,{children:["SELECT id FROM t ",(0,t.jsx)(n.strong,{children:"ORDER BY"})," t.field"]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"groupBy"}),(0,t.jsx)(n.td,{children:"[String]"}),(0,t.jsx)(n.td,{children:"\u65e0"}),(0,t.jsx)(n.td,{children:"\u5206\u7ec4\u5b57\u6bb5"}),(0,t.jsxs)(n.td,{children:["SELECT id FROM t ",(0,t.jsx)(n.strong,{children:"GROUP BY"})," t.field"]})]})]})]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8455:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/requestHandlers-583b044d7581192243bbd66dd958fcd6.png"},7812:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/settings-6ad942e7d57d34d4aa1bc3928e5e04c1.png"},5710:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var t=s(758);const i={},r=t.createContext(i);function d(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);